generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Professional {
  id                   Int        @id @default(autoincrement())
  name                 String
  email                String     @unique
  password             String
  city                 String
  serviceType          String
  description          String?
  languages            String
  availability         String?
  cities               String?
  phone                String?
  bio                  String?
  gallery              String?
  profileImage         String?
  breakEnd             String?
  breakStart           String?
  closedDays           String?
  badge                String?
  subscriptionPlan     String?
  verified             Boolean    @default(false)
  subcategories        String?
  createdAt            DateTime   @default(now())
  firstName            String?
  lastName             String?
  rejectionReason      String?
  services             String?
  status               String     @default("pending")
  teoudatZeout         String?
  passwordResetToken   String?
  passwordResetExpires DateTime?  @db.Timestamp(6)
  pricing              String?
  slug                 String?    @unique
  bookings             Booking[]
  favorites            Favorite[]
  reviews              Review[]
}

model Client {
  id                   Int        @id @default(autoincrement())
  name                 String
  email                String     @unique
  password             String?
  passwordResetToken   String?
  passwordResetExpires DateTime?  @db.Timestamp(6)
  bookings             Booking[]
  favorites            Favorite[]
  reviews              Review[]
}

model Booking {
  id              Int          @id @default(autoincrement())
  professionalId  Int
  clientId        Int
  startTime       DateTime
  endTime         DateTime
  status          String
  amount          Float?
  paymentIntentId String?
  paymentStatus   String?
  promoCode       String?
  client          Client       @relation(fields: [clientId], references: [id])
  professional    Professional @relation(fields: [professionalId], references: [id])
  messages        Message[]
  review          Review?
}

model Review {
  id             Int          @id @default(autoincrement())
  bookingId      Int          @unique
  professionalId Int
  clientId       Int
  rating         Int
  comment        String?
  createdAt      DateTime     @default(now())
  booking        Booking      @relation(fields: [bookingId], references: [id])
  client         Client       @relation(fields: [clientId], references: [id])
  professional   Professional @relation(fields: [professionalId], references: [id])
}

model Message {
  id         Int      @id @default(autoincrement())
  bookingId  Int
  senderId   Int
  senderType String
  content    String
  createdAt  DateTime @default(now())
  booking    Booking  @relation(fields: [bookingId], references: [id])
}

model Favorite {
  id             Int          @id @default(autoincrement())
  clientId       Int
  professionalId Int
  createdAt      DateTime     @default(now())
  client         Client       @relation(fields: [clientId], references: [id])
  professional   Professional @relation(fields: [professionalId], references: [id])

  @@unique([clientId, professionalId])
}

model Admin {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  name      String
  createdAt DateTime @default(now())
}
